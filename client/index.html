<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Holiday Planner Dashboard</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        /* Login Container Styles */
        #loginContainer {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            flex-direction: column;
            gap: 24px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        #loginContainer h1 {
            color: white;
            font-size: 2.5rem;
            margin: 0;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        #loginContainer p {
            color: rgba(255,255,255,0.9);
            margin: 0;
        }
        .login-btn {
            padding: 14px 28px;
            font-size: 16px;
            cursor: pointer;
            background: white;
            color: #333;
            border: none;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 500;
            box-shadow: 0 4px 14px rgba(0,0,0,0.2);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.25);
        }
        .login-btn img {
            width: 24px;
            height: 24px;
        }
        /* User Header */
        .user-header {
            position: fixed;
            top: 10px;
            right: 20px;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 12px;
            background: white;
            padding: 8px 16px;
            border-radius: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .user-header span {
            font-size: 14px;
            color: #555;
        }
        .logout-btn {
            padding: 6px 14px;
            cursor: pointer;
            background: #ff6b6b;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 13px;
            transition: background 0.2s;
        }
        .logout-btn:hover {
            background: #ee5a52;
        }
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255,255,255,0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            flex-direction: column;
            gap: 16px;
        }
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #e1e8ed;
            border-top-color: #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-spinner"></div>
        <p>Loading...</p>
    </div>

    <!-- Login Container -->
    <div id="loginContainer" style="display: none;">
        <h1>üóìÔ∏è Holiday Planner</h1>
        <p>Track your annual leave, sick days, and attendance</p>
        <button onclick="loginWithGoogle()" class="login-btn">
            <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google">
            Sign in with Google
        </button>
    </div>

    <!-- Main App Container -->
    <div id="appContainer" class="app-container" style="display: none;">
        <!-- User Header -->
        <div class="user-header">
            <span id="userEmail"></span>
            <button onclick="logout()" class="logout-btn">Logout</button>
        </div>
        <!-- Main Navigation Sidebar -->
        <aside id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <img src="images/logo.png" alt="Logo" class="sidebar-logo">
                <button id="sidebarToggleBtn" class="sidebar-toggle-btn" aria-label="Toggle sidebar">
                    <span class="burger-icon">
                        <span></span>
                        <span></span>
                        <span></span>
                    </span>
                </button>
            </div>

            <nav class="sidebar-nav">
                <button class="nav-item active" data-view="dashboard"><img src="images/dashboard.png" alt="" class="nav-icon"><span class="nav-text">Dashboard</span></button>
                <button class="nav-item" data-view="calendar"><img src="images/calender.png" alt="" class="nav-icon"><span class="nav-text">Leave Calendar</span></button>
                <button class="nav-item" data-view="attendance"><img src="images/attendance.png" alt="" class="nav-icon"><span class="nav-text">Attendance</span></button>
            </nav>
        </aside>

        <!-- Main Content Area -->
        <main class="main-view">
            <!-- Dashboard View -->
            <div id="dashboardView" class="view-container active">
                <div class="section-header">
                    <h1>Dashboard</h1>
                </div>

                <div class="dashboard-layout">
                    <!-- Main Content (Left) -->
                    <div class="dashboard-main">
                        <!-- Stats Cards Row -->
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-card-header">
                                    <h3>Annual Leave</h3>
                                </div>
                                <div class="stat-card-body">
                                    <div class="stat-row">
                                        <span class="stat-label">Total Days:</span>
                                        <span class="stat-value" id="dashTotalDays">20</span>
                                    </div>
                                    <div class="stat-row">
                                        <span class="stat-label">Used:</span>
                                        <span class="stat-value used" id="dashUsedDays">0</span>
                                    </div>
                                    <div class="stat-row">
                                        <span class="stat-label">Available:</span>
                                        <span class="stat-value available" id="dashAvailableDays">20</span>
                                    </div>
                                </div>
                            </div>

                            <div class="stat-card">
                                <div class="stat-card-header">
                                    <h3>Sick Leave</h3>
                                </div>
                                <div class="stat-card-body">
                                    <div class="stat-row">
                                        <span class="stat-label">Periods Used:</span>
                                        <span class="stat-value" id="dashSickPeriods">0</span>
                                    </div>
                                    <div class="stat-row">
                                        <span class="stat-label">Days Used:</span>
                                        <span class="stat-value" id="dashSickDays">0</span>
                                    </div>
                                </div>
                            </div>

                            <div class="stat-card">
                                <div class="stat-card-header">
                                    <h3>Attendance</h3>
                                </div>
                                <div class="stat-card-body">
                                    <div class="attendance-chart">
                                        <canvas id="attendanceChart" width="100" height="100"></canvas>
                                    </div>
                                    <span class="attendance-percentage" id="attendancePercentage">95%</span>
                                </div>
                            </div>
                        </div>

                        <!-- Dashboard Attendance Pie Charts -->
                        <div class="dashboard-pie-charts">
                            <div class="pie-chart-card">
                                <h4>Projected (Full Month)</h4>
                                <canvas id="dashProjectedChart" width="120" height="120"></canvas>
                                <div class="pie-chart-stats">
                                    <div class="pie-stat"><span class="pie-stat-color office"></span> Office: <strong id="dashProjectedOffice">0</strong></div>
                                    <div class="pie-stat"><span class="pie-stat-color holiday"></span> Holiday: <strong id="dashProjectedHoliday">0</strong></div>
                                    <div class="pie-stat"><span class="pie-stat-color sick"></span> Sick: <strong id="dashProjectedSick">0</strong></div>
                                    <div class="pie-stat"><span class="pie-stat-color unselected"></span> Unselected: <strong id="dashProjectedUnselected">0</strong></div>
                                </div>
                            </div>
                            <div class="pie-chart-card">
                                <h4>Current (Up to Today)</h4>
                                <canvas id="dashCurrentChart" width="120" height="120"></canvas>
                                <div class="pie-chart-stats">
                                    <div class="pie-stat"><span class="pie-stat-color office"></span> Office: <strong id="dashCurrentOffice">0</strong></div>
                                    <div class="pie-stat"><span class="pie-stat-color holiday"></span> Holiday: <strong id="dashCurrentHoliday">0</strong></div>
                                    <div class="pie-stat"><span class="pie-stat-color sick"></span> Sick: <strong id="dashCurrentSick">0</strong></div>
                                    <div class="pie-stat"><span class="pie-stat-color unselected"></span> Unselected: <strong id="dashCurrentUnselected">0</strong></div>
                                </div>
                            </div>
                        </div>

                        <!-- Time Off Table -->
                        <div class="time-off-section">
                            <div class="section-subheader">
                                <h2>Time Off History</h2>
                                <select id="filterTimeOff" class="filter-select">
                                    <option value="all">All</option>
                                    <option value="holiday">Holidays</option>
                                    <option value="sick">Sick Days</option>
                                    <option value="unpaid">Unpaid Leave</option>
                                </select>
                            </div>
                            <div class="table-wrapper">
                                <table class="time-off-table">
                                    <thead>
                                        <tr>
                                            <th>Date</th>
                                            <th>Day</th>
                                            <th>Type</th>
                                            <th>Label</th>
                                            <th>Action</th>
                                        </tr>
                                    </thead>
                                    <tbody id="timeOffTableBody">
                                        <tr class="empty-row">
                                            <td colspan="5">No time off recorded</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Right Sidebar Pane -->
                    <aside class="dashboard-sidebar">
                        <div class="sidebar-section">
                            <h3>Set Annual Leave</h3>
                            <div class="form-group">
                                <label for="totalHolidaysInput">Total Days:</label>
                                <div class="input-group">
                                    <input type="number" id="totalHolidaysInput" min="0" max="60" value="20">
                                    <button id="setHolidayBtnRight" class="btn btn-primary">Set</button>
                                </div>
                            </div>
                        </div>

                        <div class="sidebar-section">
                            <h3>Assign Leave</h3>
                            
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="multiSelectModeRight">
                                    <span>Multi-Select Mode</span>
                                </label>
                            </div>
                            
                            <div class="form-group">
                                <label>Selected Date(s):</label>
                                <input type="text" id="selectedDateRight" readonly placeholder="Click calendar">
                            </div>
                            
                            <div id="selectedDatesContainerRight" class="selected-dates" style="display: none;">
                                <label>Selected Dates:</label>
                                <div id="selectedDatesListRight" class="selected-dates-list"></div>
                                <button id="clearSelectionBtnRight" class="btn btn-secondary" style="width: 100%; margin-top: 8px;">Clear Selection</button>
                            </div>
                            
                            <div class="form-group">
                                <label for="holidayLabelRight">Label:</label>
                                <input type="text" id="holidayLabelRight" placeholder="e.g., Summer Break">
                            </div>

                            <div class="form-group">
                                <label for="dayTypeRight">Type:</label>
                                <select id="dayTypeRight">
                                    <option value="holiday">Holiday (counts toward allowance)</option>
                                    <option value="sick">Sick Day (doesn't count)</option>
                                    <option value="unpaid">Unpaid Leave (doesn't count)</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="holidayColorRight">Color:</label>
                                <div class="color-picker">
                                    <input type="color" id="holidayColorRight" value="#4ecdc4">
                                    <div class="color-presets">
                                        <button class="color-btn" style="background-color: #4ecdc4;" data-color="#4ecdc4" title="Teal"></button>
                                        <button class="color-btn" style="background-color: #ff6b6b;" data-color="#ff6b6b" title="Red"></button>
                                        <button class="color-btn" style="background-color: #ffd93d;" data-color="#ffd93d" title="Gold"></button>
                                        <button class="color-btn" style="background-color: #6bcf7f;" data-color="#6bcf7f" title="Green"></button>
                                        <button class="color-btn" style="background-color: #9b59b6;" data-color="#9b59b6" title="Purple"></button>
                                        <button class="color-btn" style="background-color: #3498db;" data-color="#3498db" title="Blue"></button>
                                    </div>
                                </div>
                            </div>

                            <button id="assignHolidayBtnRight" class="btn btn-success">Assign Leave</button>
                        </div>

                        <div class="sidebar-section">
                            <h3>Your Leave</h3>
                            <div id="holidayListRight" class="holiday-list">
                                <p class="empty-state">No leave assigned</p>
                            </div>
                        </div>

                        <div class="sidebar-section">
                            <h3>Actions</h3>
                            <button id="clearAllBtnRight" class="btn btn-danger btn-block">Clear All</button>
                            <button id="exportBtnRight" class="btn btn-secondary btn-block">Export</button>
                        </div>
                    </aside>
                </div>
            </div>

            <!-- Leave Calendar View -->
            <div id="calendarView" class="view-container">
                <div class="section-header">
                    <h1>Leave Calendar</h1>
                </div>

                <div class="calendar-layout">
                    <div class="calendar-main">
                        <div class="view-tabs">
                            <button id="monthViewTab" class="tab-btn active" data-view="month">Month</button>
                            <button id="yearViewTab" class="tab-btn" data-view="year">Year</button>
                        </div>

                        <div class="calendar-container">
                            <div id="monthView" class="calendar-view active">
                                <div class="calendar-header">
                                    <button id="prevMonth" class="nav-btn">Previous</button>
                                    <h2 id="monthYear"></h2>
                                    <button id="nextMonth" class="nav-btn">Next</button>
                                </div>
                                
                                <div class="weekdays">
                                    <div class="weekday">Mon</div>
                                    <div class="weekday">Tue</div>
                                    <div class="weekday">Wed</div>
                                    <div class="weekday">Thu</div>
                                    <div class="weekday">Fri</div>
                                    <div class="weekday">Sat</div>
                                    <div class="weekday">Sun</div>
                                </div>
                                
                                <div id="calendar" class="calendar-grid"></div>
                                
                                <div class="calendar-legend">
                                    <div class="legend-item">
                                        <div class="legend-color" style="background-color: #4ecdc4;"></div>
                                        <span>Holiday</span>
                                    </div>
                                    <div class="legend-item">
                                        <div class="legend-color" style="background: linear-gradient(135deg, #ffe0e0 0%, #ffcccc 100%);"></div>
                                        <span>Sick Day</span>
                                    </div>
                                    <div class="legend-item">
                                        <div class="legend-color" style="background: linear-gradient(135deg, #ffe8cc 0%, #ffd99f 100%);"></div>
                                        <span>Unpaid Leave</span>
                                    </div>
                                    <div class="legend-item">
                                        <div class="legend-color" style="background: linear-gradient(135deg, #ffe5e5 0%, #ffcccc 100%);"></div>
                                        <span>Bank Holiday</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div id="yearView" class="calendar-view">
                                <div class="year-header">
                                    <button id="prevYear" class="nav-btn">Previous Year</button>
                                    <h2 id="yearDisplay"></h2>
                                    <button id="nextYear" class="nav-btn">Next Year</button>
                                </div>
                                
                                <div id="yearCalendar" class="year-calendar"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Attendance View -->
            <div id="attendanceView" class="view-container">
                <div class="section-header">
                    <h1>Attendance</h1>
                </div>

                <div class="attendance-layout">
                    <!-- Left Panel: Configuration -->
                    <aside class="attendance-config">
                        <div class="config-section">
                            <h3>Select Month & Year</h3>
                            <div class="form-group">
                                <label for="attendanceMonthSelector">Month/Year:</label>
                                <div class="date-selector">
                                    <select id="attendanceMonthSelector">
                                        <!-- Populated by JavaScript -->
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="config-section">
                            <h3>Required Days in Office</h3>
                            
                            <div class="form-group">
                                <label for="requiredDaysType">Calculate by:</label>
                                <select id="requiredDaysType">
                                    <option value="days">Number of Days</option>
                                    <option value="percentage">Percentage</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="requiredDaysValue">
                                    <span id="requiredDaysLabel">Required Days:</span>
                                </label>
                                <input type="number" id="requiredDaysValue" min="0" value="15">
                            </div>

                            <div class="config-box">
                                <label>
                                    <input type="checkbox" id="countBankHolidays" checked>
                                    <span>Count Bank Holidays toward office days</span>
                                </label>
                            </div>

                            <div class="config-box">
                                <label>
                                    <input type="checkbox" id="countAnnualLeave" checked>
                                    <span>Count Annual Leave toward office days</span>
                                </label>
                            </div>

                            <div class="config-box">
                                <label>
                                    <input type="checkbox" id="countSickDays" checked>
                                    <span>Count Sick Days toward office days</span>
                                </label>
                            </div>

                            <div class="stats-box">
                                <h4>Attendance Statistics</h4>
                                <div class="stat-line">
                                    <span>Total Weekdays:</span>
                                    <strong id="totalWeekdaysCount">22</strong>
                                </div>
                                <div class="stat-line">
                                    <span>Required Days:</span>
                                    <strong id="requiredDaysCount">15</strong>
                                </div>
                                <div class="stat-line highlighted">
                                    <span>Office Days Met:</span>
                                    <strong id="officeDaysMet">0 / 15</strong>
                                </div>
                            </div>
                        <div class="config-section">
                            <h3>Mark Selected Days</h3>
                            <div class="day-selector-inline">
                                <div class="button-group">
                                    <button id="markOfficeBtn" class="day-type-btn office">Office Day</button>
                                    <button id="markRemoteBtn" class="day-type-btn remote">Remote Work</button>
                                    <button id="markSickBtn" class="day-type-btn sick">Sick Day</button>
                                    <button id="markAnnualLeaveBtn" class="day-type-btn leave">Annual Leave</button>
                                    <button id="clearSelectionBtn" class="day-type-btn clear">Clear</button>
                                </div>
                            </div>
                        </div>
                    </aside>

                    <!-- Right Panel: Calendar -->
                    <div class="attendance-calendar">
                        <div class="calendar-nav">
                            <button id="attendancePrevMonth" class="nav-btn">Previous</button>
                            <h2 id="attendanceMonthYear"></h2>
                            <button id="attendanceNextMonth" class="nav-btn">Next</button>
                        </div>

                        <div class="weekdays">
                            <div class="weekday">Mon</div>
                            <div class="weekday">Tue</div>
                            <div class="weekday">Wed</div>
                            <div class="weekday">Thu</div>
                            <div class="weekday">Fri</div>
                            <div class="weekday">Sat</div>
                            <div class="weekday">Sun</div>
                        </div>

                        <div id="attendanceGridContainer" class="calendar-grid"></div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Firebase SDK -->
    <script type="module" src="script.js"></script>
</body>
</html>
